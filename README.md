# Genomic file string replacement
A tool for search and replace strings or anonymise genomic files.  



# Use cases 

# Example
```bash
python main.py output_command --fileinfo ./REQID33/fileinfo.tsv --outdir ./test_outdir --outfilepath ./test_output.sh --use_symlink
```
# Subcommands
```bash
$ python main.py prepare --help
usage: main.py prepare [-h] --sourcedir PATH [--source_filelist PATH] --outdir
                       PATH --replacement_file PATH
                       [--fastq_filename_fields [FASTQ_FILENAME_FIELDS [FASTQ_FILENAME_FIELDS ...]]]
                       [--include_only_ext [EXT [EXT ...]]]
                       [--ignore_extension [EXT [EXT ...]]]

Parsing a data directory and output a tsv-file of file information in
preparation for the `output_command` stage.

optional arguments:
  -h, --help            show this help message and exit
  --sourcedir PATH      Path to input directory.
  --source_filelist PATH
                        A file containing the list of file paths relative to
                        --sourcedir to be processed. If not specified, all
                        files in --sourcedir will be considered.
  --outdir PATH         Path to output directory. Existing files will be
                        overwritten.
  --replacement_file PATH
                        Path to a 2 column TSV-file containing the original
                        string in the first column and their corresponding
                        replacement string in the second column.
  --fastq_filename_fields [FASTQ_FILENAME_FIELDS [FASTQ_FILENAME_FIELDS ...]]
                        A list of zero-based indices to specify which
                        `_`-separated fields need to be randomised.
  --include_only_ext [EXT [EXT ...]]
                        The set of file extension to include. All other
                        extensions will be ignored. If not specified, all
                        files in `sourcedir` will be included. Files specified
                        by --ignore_extension will still be excluded.
  --ignore_extension [EXT [EXT ...]]
                        The set of file extension to ignore. Any files with
                        this extension in `sourcedir` will have their filename
                        changed but their content untouched.


$ python main.py output_command --help
usage: main.py output_command [-h] --fileinfo PATH --outdir PATH --outfilepath
                              PATH [--use_symlink] [--anon_strlength LENGTH]

Read in a tsv-file of file information including filepath, filetype, batch,
sample_id, output a list of anonymisation commands for each of them.

optional arguments:
  -h, --help            show this help message and exit
  --fileinfo PATH       Path to tsv-file of table containing information
                        needed to determine operation to perform on each
                        files.
  --outdir PATH         An output directory to be used in the list of
                        generated commands.
  --outfilepath PATH    Path to output file where generated commands end up.
  --use_symlink         If specified, any file specified in --ignore_extension
                        will be symlinked instead of copied.
  --anon_strlength LENGTH
                        Length of anonymised ID. Default: 16


$ python main.py run_command --help
usage: main.py run_command [-h] --commandfilepath PATH
                           [--multiprocessing THREADS]
                           [--polling_period POLLING_PERIOD] [--logfile PATH]

Run a list of shell commands in multiprocessing mode.

optional arguments:
  -h, --help            show this help message and exit
  --commandfilepath PATH
                        The file path to the file containing a list of unix
                        commands generated by `prepare` to run.
  --multiprocessing THREADS
                        Number of processes to spawn to run the program.
                        Default to not using any multiprocessing.
  --polling_period POLLING_PERIOD
                        Polling period in seconds for --multiprocessing
                        poller. Default: 15 seconds.
  --logfile PATH        A file to store log outputs.

``` 